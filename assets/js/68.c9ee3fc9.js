(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{469:function(e,t,s){"use strict";s.r(t);var r=s(2),a=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("blockquote",[t("p",[e._v("selenium并不是万能的，有时候页面上操作无法实现的，这时候就需要借助JS来完成了")])]),e._v(" "),t("p",[e._v("当页面上的元素超过一屏后，想操作屏幕下方的元素，是不能直接定位到，会报元素不可见的。这时候需要借助滚动条来拖动屏幕，使被操作的元素显示在当前的屏幕上。滚动条是无法直接用定位工具来定位的。selenium里面也没有直接的方法去控制滚动条，这时候只能借助J了，还好selenium提供了一个操作js的方法:execute_script()，可以直接执行js的脚本")]),e._v(" "),t("h2",{attrs:{id:"一-控制滚动条高度"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-控制滚动条高度"}},[e._v("#")]),e._v(" 一. 控制滚动条高度")]),e._v(" "),t("h3",{attrs:{id:"_1-1滚动条回到顶部"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1滚动条回到顶部"}},[e._v("#")]),e._v(" 1.1滚动条回到顶部：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("js=\"var q=document.getElementById('id').scrollTop=0\"\ndriver.execute_script(js)\n")])])]),t("h3",{attrs:{id:"_1-2滚动条拉到底部"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2滚动条拉到底部"}},[e._v("#")]),e._v(" 1.2滚动条拉到底部")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('js="var q=document.documentElement.scrollTop=10000"\ndriver.execute_script(js)\n')])])]),t("p",[e._v("可以修改scrollTop 的值，来定位右侧滚动条的位置，0是最上面，10000是最底部")]),e._v(" "),t("p",[e._v("以上方法在Firefox和IE浏览器上上是可以的，但是用Chrome浏览器，发现不管用。Chrome浏览器解决办法：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('js = "var q=document.body.scrollTop=0"\ndriver.execute_script(js)\n')])])]),t("h2",{attrs:{id:"二-横向滚动条"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-横向滚动条"}},[e._v("#")]),e._v(" 二.横向滚动条")]),e._v(" "),t("h3",{attrs:{id:"_2-1-有时候浏览器页面需要左右滚动-一般屏幕最大化后-左右滚动的情况已经很少见了"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-有时候浏览器页面需要左右滚动-一般屏幕最大化后-左右滚动的情况已经很少见了"}},[e._v("#")]),e._v(" 2.1 有时候浏览器页面需要左右滚动（一般屏幕最大化后，左右滚动的情况已经很少见了)")]),e._v(" "),t("h3",{attrs:{id:"_2-2-通过左边控制横向和纵向滚动条scrollto-x-y"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-通过左边控制横向和纵向滚动条scrollto-x-y"}},[e._v("#")]),e._v(" 2.2 通过左边控制横向和纵向滚动条scrollTo(x, y)")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('js = "window.scrollTo(100,400)"\ndriver.execute_script(js)\n')])])]),t("h2",{attrs:{id:"三-元素聚焦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-元素聚焦"}},[e._v("#")]),e._v(" 三.元素聚焦")]),e._v(" "),t("p",[e._v("虽然用上面的方法可以解决拖动滚动条的位置问题，但是有时候无法确定我需要操作的元素在什么位置，有可能每次打开的页面不一样，元素所在的位置也不一样，怎么办呢？这个时候我们可以先让页面直接跳到元素出现的位置，然后就可以操作了")]),e._v(" "),t("p",[e._v("同样需要借助JS去实现。 具体如下：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('target = driver.find_element_by_xxxx()\ndriver.execute_script("arguments[0].scrollIntoView();", target)\n')])])]),t("h2",{attrs:{id:"四-参考代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-参考代码"}},[e._v("#")]),e._v(" 四. 参考代码")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('from selenium import webdriver\nfrom lxml import etree\nimport time\n\nurl = "https://search.jd.com/Search?keyword=%E7%AC%94%E8%AE%B0%E6%9C%AC&enc=utf-8&wq=%E7%AC%94%E8%AE%B0%E6%9C%AC&pvid=845d019c94f6476ca5c4ffc24df6865a"\n# 加载浏览器\nwd = webdriver.Firefox()\n# 发送请求\nwd.get(url)\n# 要执行的js\njs = "var q = document.documentElement.scrollTop=10000"\n# 执行js\nwd.execute_script(js)\n\ntime.sleep(3)\n# 解析数据\ne = etree.HTML(wd.page_source)\n# 提取数据的xpath\nprice_xpath = \'//ul[@class="gl-warp clearfix"]//div[@class="p-price"]/strong/i/text()\'\n# 提取数据的\ninfos = e.xpath(price_xpath)\n\nprint(len(infos))\n# 关闭浏览器\nwd.quit()\n\n\n')])])])])}),[],!1,null,null,null);t.default=a.exports}}]);