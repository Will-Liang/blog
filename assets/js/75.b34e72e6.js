(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{473:function(t,s,n){"use strict";n.r(s);var a=n(2),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("strong",[t._v("知识点：")])]),t._v(" "),s("ul",[s("li",[t._v("掌握 selenium控制标签页的切换")]),t._v(" "),s("li",[t._v("掌握 selenium控制iframe的切换")]),t._v(" "),s("li",[t._v("掌握 利用selenium获取cookie的方法")]),t._v(" "),s("li",[t._v("掌握 手动实现页面等待")]),t._v(" "),s("li",[t._v("掌握 selenium控制浏览器执行js代码的方法")]),t._v(" "),s("li",[t._v("掌握 selenium开启无界面模式")]),t._v(" "),s("li",[t._v("了解 selenium使用代理ip")]),t._v(" "),s("li",[t._v("了解 selenium替换user-agent")])]),t._v(" "),s("h2",{attrs:{id:"_1-selenium标签页的切换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-selenium标签页的切换"}},[t._v("#")]),t._v(" 1. selenium标签页的切换")]),t._v(" "),s("blockquote",[s("p",[t._v("当selenium控制浏览器打开多个标签页时，如何控制浏览器在不同的标签页中进行切换呢？需要我们做以下两步：")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("获取所有标签页的窗口句柄")])]),t._v(" "),s("li",[s("p",[t._v("利用窗口句柄字切换到句柄指向的标签页")]),t._v(" "),s("ul",[s("li",[t._v("这里的窗口句柄是指：指向标签页对象的标识")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://baike.baidu.com/item/%E5%8F%A5%E6%9F%84/3527587?fr=aladdin",target:"_blank",rel:"noopener noreferrer"}},[t._v("句柄"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[s("p",[t._v("具体的方法")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 1. 获取当前所有的标签页的句柄构成的列表\ncurrent_windows = driver.window_handles\n\n# 2. 根据标签页句柄列表索引下标进行切换\ndriver.switch_to.window(current_windows[0])\n")])])])]),t._v(" "),s("li",[s("p",[t._v("参考代码示例：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.baidu.com/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kw'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'python'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'su'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过执行js来新开一个标签页")]),t._v("\njs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'window.open(\"https://www.sogou.com\");'")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. 获取当前所有的窗口")]),t._v("\nwindows "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles\n\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 根据窗口索引进行切换")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"_2-switch-to切换frame标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-switch-to切换frame标签"}},[t._v("#")]),t._v(" 2. switch_to切换frame标签")]),t._v(" "),s("blockquote",[s("h5",{attrs:{id:"iframe是html中常用的一种技术-即一个页面中嵌套了另一个网页-selenium默认是访问不了frame中的内容的-对应的解决思路是driver-switch-to-frame-frame-element-。接下来我们通过qq邮箱模拟登陆来学习这个知识点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#iframe是html中常用的一种技术-即一个页面中嵌套了另一个网页-selenium默认是访问不了frame中的内容的-对应的解决思路是driver-switch-to-frame-frame-element-。接下来我们通过qq邮箱模拟登陆来学习这个知识点"}},[t._v("#")]),t._v(" iframe是html中常用的一种技术，即一个页面中嵌套了另一个网页，selenium默认是访问不了frame中的内容的，对应的解决思路是"),s("code",[t._v("driver.switch_to.frame(frame_element)")]),t._v("。接下来我们通过qq邮箱模拟登陆来学习这个知识点")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("参考代码：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nurl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://mail.qq.com/cgi-bin/loginpage'")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nlogin_frame "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'login_frame'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据id定位 frame元素")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("frame"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_frame"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 转向到该frame中")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_xpath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//*[@id=\"u\"]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1596930226@qq.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_xpath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//*[@id=\"p\"]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hahamimashicuode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_xpath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//*[@id=\"login_button\"]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""操作frame外边的元素需要切换出去"""')]),t._v("\nwindows "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("windows"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ncontent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_class_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'login_pictures_title'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("总结：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("切换到定位的frame标签嵌套的页面中")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("driver.switch_to.frame(通过find_element_by函数定位的frame、iframe标签对象)")])])])]),t._v(" "),s("li",[s("p",[t._v("利用切换标签页的方式切出frame标签")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("windows = driver.window_handles\ndriver.switch_to.window(windows[0])\n")])])])])])])])])]),t._v(" "),s("h2",{attrs:{id:"_3-selenium对cookie的处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-selenium对cookie的处理"}},[t._v("#")]),t._v(" 3. selenium对cookie的处理")]),t._v(" "),s("blockquote",[s("p",[t._v("selenium能够帮助我们处理页面中的cookie，比如获取、删除，接下来我们就学习这部分知识")])]),t._v(" "),s("h3",{attrs:{id:"_3-1-获取cookie"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-获取cookie"}},[t._v("#")]),t._v(" 3.1 获取cookie")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("driver.get_cookies()")]),t._v("返回列表，其中包含的是完整的cookie信息！不光有name、value，还有domain等cookie其他维度的信息。所以如果想要把获取的cookie信息和requests模块配合使用的话，需要转换为name、value作为键值对的cookie字典")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# 获取当前标签页的全部cookie信息\nprint(driver.get_cookies())\n# 把cookie转化为字典\ncookies_dict = {cookie[‘name’]: cookie[‘value’] for cookie in driver.get_cookies()}\n")])])]),s("h3",{attrs:{id:"_3-2-删除cookie"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-删除cookie"}},[t._v("#")]),t._v(" 3.2 删除cookie")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('#删除一条cookie\ndriver.delete_cookie("CookieName")\n\n# 删除所有的cookie\ndriver.delete_all_cookies()\n')])])]),s("h2",{attrs:{id:"_4-selenium控制浏览器执行js代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-selenium控制浏览器执行js代码"}},[t._v("#")]),t._v(" 4. selenium控制浏览器执行js代码")]),t._v(" "),s("blockquote",[s("p",[t._v("selenium可以让浏览器执行我们规定的js代码，运行下列代码查看运行效果")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.itcast.cn/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\njs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'window.scrollTo(0,document.body.scrollHeight)'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# js语句")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行js的方法")]),t._v("\n\ntime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("执行js的方法："),s("code",[t._v("driver.execute_script(js)")])])]),t._v(" "),s("h2",{attrs:{id:"_5-页面等待"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-页面等待"}},[t._v("#")]),t._v(" 5. 页面等待")]),t._v(" "),s("blockquote",[s("p",[t._v("页面在加载的过程中需要花费时间等待网站服务器的响应，在这个过程中标签元素有可能还没有加载出来，是不可见的，如何处理这种情况呢？")])]),t._v(" "),s("ol",[s("li",[t._v("页面等待分类")]),t._v(" "),s("li",[t._v("强制等待介绍")]),t._v(" "),s("li",[t._v("显式等待介绍")]),t._v(" "),s("li",[t._v("隐式等待介绍")]),t._v(" "),s("li",[t._v("手动实现页面等待")])]),t._v(" "),s("h3",{attrs:{id:"_5-1-页面等待的分类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-页面等待的分类"}},[t._v("#")]),t._v(" 5.1 页面等待的分类")]),t._v(" "),s("blockquote",[s("p",[t._v("首先我们就来了解以下selenium页面等待的分类")])]),t._v(" "),s("ol",[s("li",[t._v("强制等待")]),t._v(" "),s("li",[t._v("隐式等待")]),t._v(" "),s("li",[t._v("显式等待")])]),t._v(" "),s("h3",{attrs:{id:"_5-2-强制等待-了解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-强制等待-了解"}},[t._v("#")]),t._v(" 5.2 强制等待（了解）")]),t._v(" "),s("ul",[s("li",[t._v("其实就是time.sleep()")]),t._v(" "),s("li",[t._v("缺点时不智能，设置的时间太短，元素还没有加载出来；设置的时间太长，则会浪费时间")])]),t._v(" "),s("h3",{attrs:{id:"_5-3-隐式等待"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-隐式等待"}},[t._v("#")]),t._v(" 5.3 隐式等待")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("隐式等待针对的是元素定位，隐式等待设置了一个时间，在一段时间内判断元素是否定位成功，如果完成了，就进行下一步")])]),t._v(" "),s("li",[s("p",[t._v("在设置的时间内没有定位成功，则会报超时加载")])]),t._v(" "),s("li",[s("p",[t._v("示例代码")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("from selenium import webdriver\n\ndriver = webdriver.Chrome()  \n\ndriver.implicitly_wait(10) # 隐式等待，最长等20秒  \n\ndriver.get('https://www.baidu.com')\n\ndriver.find_element_by_xpath()\n\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"_5-4-显式等待-了解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-显式等待-了解"}},[t._v("#")]),t._v(" 5.4 显式等待（了解）")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("每经过多少秒就查看一次等待条件是否达成，如果达成就停止等待，继续执行后续代码")])]),t._v(" "),s("li",[s("p",[t._v("如果没有达成就继续等待直到超过规定的时间后，报超时异常")])]),t._v(" "),s("li",[s("p",[t._v("示例代码")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("from selenium import webdriver  \nfrom selenium.webdriver.support.wait import WebDriverWait  \nfrom selenium.webdriver.support import expected_conditions as EC  \nfrom selenium.webdriver.common.by import By \n\ndriver = webdriver.Chrome()\n\ndriver.get('https://www.baidu.com')\n\n# 显式等待\nWebDriverWait(driver, 20, 0.5).until(\n    EC.presence_of_element_located((By.LINK_TEXT, '好123')))  \n# 参数20表示最长等待20秒\n# 参数0.5表示0.5秒检查一次规定的标签是否存在\n# EC.presence_of_element_located((By.LINK_TEXT, '好123')) 表示通过链接文本内容定位标签\n# 每0.5秒一次检查，通过链接文本内容定位标签是否存在，如果存在就向下继续执行；如果不存在，直到20秒上限就抛出异常\n\nprint(driver.find_element_by_link_text('好123').get_attribute('href'))\ndriver.quit() \n")])])])])]),t._v(" "),s("h3",{attrs:{id:"_5-5-手动实现页面等待"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-手动实现页面等待"}},[t._v("#")]),t._v(" 5.5 手动实现页面等待")]),t._v(" "),s("blockquote",[s("p",[t._v("在了解了隐式等待和显式等待以及强制等待后，我们发现并没有一种通用的方法来解决页面等待的问题，比如“页面需要滑动才能触发ajax异步加载”的场景，那么接下来我们就以"),s("a",{attrs:{href:"https://www.taobao.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("淘宝网首页"),s("OutboundLink")],1),t._v("为例，手动实现页面等待")])]),t._v(" "),s("ul",[s("li",[t._v("原理：\n"),s("ul",[s("li",[t._v("利用强制等待和显式等待的思路来手动实现")]),t._v(" "),s("li",[t._v("不停的判断或有次数限制的判断某一个标签对象是否加载完毕（是否存在）")])])]),t._v(" "),s("li",[t._v("实现代码如下：")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("import time\nfrom selenium import webdriver\ndriver = webdriver.Chrome('/home/worker/Desktop/driver/chromedriver')\n\ndriver.get('https://www.taobao.com/')\ntime.sleep(1)\n\n# i = 0\n# while True:\nfor i in range(10):\n    i += 1\n    try:\n        time.sleep(3)\n        element = driver.find_element_by_xpath('//div[@class=\"shop-inner\"]/h3[1]/a')\n        print(element.get_attribute('href'))\n        break\n    except:\n        js = 'window.scrollTo(0, {})'.format(i*500) # js语句\n        driver.execute_script(js) # 执行js的方法\ndriver.quit()\n")])])]),s("h2",{attrs:{id:"_6-selenium开启无界面模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-selenium开启无界面模式"}},[t._v("#")]),t._v(" 6. selenium开启无界面模式")]),t._v(" "),s("blockquote",[s("p",[t._v("绝大多数服务器是没有界面的，selenium控制谷歌浏览器也是存在无界面模式的，这一小节我们就来学习如何开启无界面模式（又称之为无头模式）")])]),t._v(" "),s("ul",[s("li",[t._v("开启无界面模式的方法\n"),s("ul",[s("li",[t._v("实例化配置对象\n"),s("ul",[s("li",[s("code",[t._v("options = webdriver.ChromeOptions()")])])])]),t._v(" "),s("li",[t._v("配置对象添加开启无界面模式的命令\n"),s("ul",[s("li",[s("code",[t._v('options.add_argument("--headless")')])])])]),t._v(" "),s("li",[t._v("配置对象添加禁用gpu的命令\n"),s("ul",[s("li",[s("code",[t._v('options.add_argument("--disable-gpu")')])])])]),t._v(" "),s("li",[t._v("实例化带有配置对象的driver对象\n"),s("ul",[s("li",[s("code",[t._v("driver = webdriver.Chrome(chrome_options=options)")])])])])])]),t._v(" "),s("li",[t._v("注意：macos中chrome浏览器59+版本，Linux中57+版本才能使用无界面模式！")]),t._v(" "),s("li",[t._v("参考代码如下：")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\noptions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ChromeOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个配置对象")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_argument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--headless"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启无界面模式")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_argument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--disable-gpu"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁用gpu")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# options.set_headles() # 无界面模式的另外一种开启方式")]),t._v("\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chrome_options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实例化带有配置的driver对象")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.itcast.cn'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"_7-selenium使用代理ip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-selenium使用代理ip"}},[t._v("#")]),t._v(" 7. selenium使用代理ip")]),t._v(" "),s("blockquote",[s("p",[t._v("selenium控制浏览器也是可以使用代理ip的！")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("使用代理ip的方法")]),t._v(" "),s("ul",[s("li",[t._v("实例化配置对象\n"),s("ul",[s("li",[s("code",[t._v("options = webdriver.ChromeOptions()")])])])]),t._v(" "),s("li",[t._v("配置对象添加使用代理ip的命令\n"),s("ul",[s("li",[s("code",[t._v("options.add_argument('--proxy-server=http://202.20.16.82:9527')")])])])]),t._v(" "),s("li",[t._v("实例化带有配置对象的driver对象\n"),s("ul",[s("li",[s("code",[t._v("driver = webdriver.Chrome('./chromedriver', chrome_options=options)")])])])])])]),t._v(" "),s("li",[s("p",[t._v("参考代码如下：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\noptions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ChromeOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个配置对象")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_argument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'--proxy-server=http://202.20.16.82:9527'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用代理ip")]),t._v("\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chrome_options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实例化带有配置的driver对象")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.itcast.cn'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"_8-selenium替换user-agent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-selenium替换user-agent"}},[t._v("#")]),t._v(" 8. selenium替换user-agent")]),t._v(" "),s("blockquote",[s("p",[t._v("selenium控制谷歌浏览器时，User-Agent默认是谷歌浏览器的，这一小节我们就来学习使用不同的User-Agent")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("替换user-agent的方法")]),t._v(" "),s("ul",[s("li",[t._v("实例化配置对象\n"),s("ul",[s("li",[s("code",[t._v("options = webdriver.ChromeOptions()")])])])]),t._v(" "),s("li",[t._v("配置对象添加替换UA的命令\n"),s("ul",[s("li",[s("code",[t._v("options.add_argument('--user-agent=Mozilla/5.0 HAHA')")])])])]),t._v(" "),s("li",[t._v("实例化带有配置对象的driver对象\n"),s("ul",[s("li",[s("code",[t._v("driver = webdriver.Chrome('./chromedriver', chrome_options=options)")])])])])])]),t._v(" "),s("li",[s("p",[t._v("参考代码如下：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\noptions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ChromeOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个配置对象")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_argument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'--user-agent=Mozilla/5.0 HAHA'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 替换User-Agent")]),t._v("\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./chromedriver'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" chrome_options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.itcast.cn'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);